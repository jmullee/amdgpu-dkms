

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installing or Uninstalling AMDGPU &mdash; amdgpu graphics and compute stack 21.10-1247438 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reporting Bugs" href="install-bugrep.html" />
    <link rel="prev" title="Using the amdgpu-install Script" href="install-script.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> amdgpu graphics and compute stack
          

          
          </a>

          
            
            
              <div class="version">
                21.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preamble.html">Preamble</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-prereq.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-script.html">Using the <code class="docutils literal notranslate"><span class="pre">amdgpu-install</span></code> Script</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installing or Uninstalling AMDGPU</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-all-open-variant">Installing the All-Open Variant</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-pro-variant">Installing the Pro Variant</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#opengl-default-component">OpenGL (Default Component)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#opencl-optional-component">OpenCL (Optional Component)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vulkan-default-component">Vulkan (Default Component)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#px-platform-support-ubuntu-only">PX Platform Support (Ubuntu only)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#secure-boot-support">Secure Boot Support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ubuntu-and-debian-based-systems">Ubuntu and Debian Based Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rhel-centos-systems">RHEL/CentOS Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sle-systems">SLE Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-mok-manager-to-enroll-the-mok-certificate">Using the MOK Manager to Enroll the MOK Certificate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#uninstalling-the-amdgpu-graphics-stack">Uninstalling the AMDGPU Graphics Stack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install-bugrep.html">Reporting Bugs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">amdgpu graphics and compute stack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Installing or Uninstalling AMDGPU</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/install-installing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-or-uninstalling-amdgpu">
<h1><a class="toc-backref" href="#id1">Installing or Uninstalling AMDGPU</a><a class="headerlink" href="#installing-or-uninstalling-amdgpu" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#installing-or-uninstalling-amdgpu" id="id1">Installing or Uninstalling AMDGPU</a><ul>
<li><a class="reference internal" href="#installing-the-all-open-variant" id="id2">Installing the All-Open Variant</a></li>
<li><a class="reference internal" href="#installing-the-pro-variant" id="id3">Installing the Pro Variant</a><ul>
<li><a class="reference internal" href="#opengl-default-component" id="id4">OpenGL (Default Component)</a></li>
<li><a class="reference internal" href="#opencl-optional-component" id="id5">OpenCL (Optional Component)</a></li>
<li><a class="reference internal" href="#vulkan-default-component" id="id6">Vulkan (Default Component)</a></li>
<li><a class="reference internal" href="#px-platform-support-ubuntu-only" id="id7">PX Platform Support (Ubuntu only)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#secure-boot-support" id="id8">Secure Boot Support</a><ul>
<li><a class="reference internal" href="#ubuntu-and-debian-based-systems" id="id9">Ubuntu and Debian Based Systems</a></li>
<li><a class="reference internal" href="#rhel-centos-systems" id="id10">RHEL/CentOS Systems</a></li>
<li><a class="reference internal" href="#sle-systems" id="id11">SLE Systems</a></li>
<li><a class="reference internal" href="#using-the-mok-manager-to-enroll-the-mok-certificate" id="id12">Using the MOK Manager to Enroll the MOK Certificate</a></li>
</ul>
</li>
<li><a class="reference internal" href="#uninstalling-the-amdgpu-graphics-stack" id="id13">Uninstalling the AMDGPU Graphics Stack</a></li>
</ul>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="installing-the-all-open-variant">
<h2><a class="toc-backref" href="#id2">Installing the All-Open Variant</a><a class="headerlink" href="#installing-the-all-open-variant" title="Permalink to this headline">¶</a></h2>
<p>Run the following command to install the All-Open variant:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./amdgpu-install -y
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">-y</span></code> option installs non-interactively. See
<a class="reference internal" href="install-script.html"><span class="doc">Using the amdgpu-install script</span></a> for more
information.</p>
</div>
<hr class="docutils" />
<p>Reboot the target system after running <code class="docutils literal notranslate"><span class="pre">amdgpu-install</span></code>.</p>
</div>
<div class="section" id="installing-the-pro-variant">
<h2><a class="toc-backref" href="#id3">Installing the Pro Variant</a><a class="headerlink" href="#installing-the-pro-variant" title="Permalink to this headline">¶</a></h2>
<p>Refer to the following table to understand how to install a combination of Pro
components:</p>
<table border="1" class="docutils">
<colgroup>
<col width="78%" />
<col width="22%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Command</strong></td>
<td><strong>Installed
Components</strong></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">./amdgpu-pro-install</span> <span class="pre">-y</span></code></td>
<td><ul class="first last simple">
<li>Base kernel</li>
<li>Accelerated
graphics</li>
<li>Mesa
multimedia</li>
<li>Pro OpenGL</li>
<li>Pro Vulkan</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">./amdgpu-pro-install</span> <span class="pre">-y</span> <span class="pre">--opencl=rocr,legacy</span></code></td>
<td><ul class="first last simple">
<li>Base kernel</li>
<li>Accelerated
graphics</li>
<li>Mesa
multimedia</li>
<li>Pro OpenGL</li>
<li>Pro Vulkan</li>
<li>Pro OpenCL</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">./amdgpu-pro-install</span> <span class="pre">-y</span> <span class="pre">--opencl=rocr,legacy</span> <span class="pre">--headless</span></code></td>
<td><ul class="first last simple">
<li>Only base
kernel</li>
<li>Pro OpenCL
(headless mode)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Reboot the target system after running <code class="docutils literal notranslate"><span class="pre">amdgpu-pro-install</span></code>.</p>
<p>For more information, refer to the following sections to understand how to
install individual components.</p>
<div class="section" id="opengl-default-component">
<h3><a class="toc-backref" href="#id4">OpenGL (Default Component)</a><a class="headerlink" href="#opengl-default-component" title="Permalink to this headline">¶</a></h3>
<p>OpenGL is a default component of the Pro variant.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unless a headless installation is requested, OpenGL is installed.</p>
</div>
</div>
<div class="section" id="opencl-optional-component">
<span id="installation-opencl-optional-component"></span><h3><a class="toc-backref" href="#id5">OpenCL (Optional Component)</a><a class="headerlink" href="#opencl-optional-component" title="Permalink to this headline">¶</a></h3>
<p>OpenCL is an optional component of the Pro variant and is installed only if it is
specifically requested.</p>
<p>Two different implementations of OpenCL (legacy and ROCr) are provided.
Either of these implementations or both of them can be installed
on the target system.</p>
<p>To use the ROCr implementation of OpenCL, the running user might need
additional permissions depending on OS policy. If <code class="docutils literal notranslate"><span class="pre">clinfo</span></code> or any openCL
application does not work, check ownership and permissions of the render
nodes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls -l /dev/dri/render*
</pre></div>
</div>
<p>If the render nodes are owned by group render but not readable and writable by
all users, consider adding the current user to the render group:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo usermod -a -G render <span class="nv">$LOGNAME</span>
</pre></div>
</div>
<p>If you are an administrator, <code class="docutils literal notranslate"><span class="pre">$LOGNAME</span></code> can be replaced by any valid
username.</p>
<p>Alternatively, if the render nodes are owned by the video group but not
readable and writable by all users, consider adding the current user to the
video group:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo usermod -a -G video <span class="nv">$LOGNAME</span>
</pre></div>
</div>
<p>Different Linux distributions have different ownership and permission policies
for render nodes. In addition, your organization may have its own policies
that override the distribution defaults. If unsure, consult the documentation
for your distribution or your organization.</p>
<p>In some scenarios, it may be desirable to install <strong>only</strong> the OpenCL portion
of the Pro variant (omitting the OpenGL portion), which can be accomplished
by adding the <code class="docutils literal notranslate"><span class="pre">--headless</span></code> option. The typical use case is headless compute.</p>
</div>
<div class="section" id="vulkan-default-component">
<h3><a class="toc-backref" href="#id6">Vulkan (Default Component)</a><a class="headerlink" href="#vulkan-default-component" title="Permalink to this headline">¶</a></h3>
<p>Vulkan is a default component of the Pro variant.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unless a headless installation is requested, Vulkan is installed.</p>
</div>
</div>
<div class="section" id="px-platform-support-ubuntu-only">
<h3><a class="toc-backref" href="#id7">PX Platform Support (Ubuntu only)</a><a class="headerlink" href="#px-platform-support-ubuntu-only" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">PX is deprecated in the latest version of the AMDGPU Graphics Stack.
The All-Open variant with PRIME GPU offloading is recommend for all
mobile variants with hybrid graphics, which allows GPU workloads to
be offloaded to a discrete GPU on demand.</p>
</div>
<p>For PX (<em>PowerExpress</em>) platform support, use the <code class="docutils literal notranslate"><span class="pre">--px</span></code> option as shown in
the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./amdgpu--pro-install --px
</pre></div>
</div>
</div>
</div>
<div class="section" id="secure-boot-support">
<h2><a class="toc-backref" href="#id8">Secure Boot Support</a><a class="headerlink" href="#secure-boot-support" title="Permalink to this headline">¶</a></h2>
<p>The kernel modules used by the AMDGPU Graphics Stack rely on DKMS. DKMS will
compile the modules during installation and re-compile the modules when kernel
is updated. To use secure boot with DKMS, a machine owned key (MOK), which is
unique to the system, will be generated to sign the kernel modules.</p>
<p>Please see the section below that applies to the distro of the target system.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you already have a MOK enrolled on your system, the driver package
expects the private key for this MOK to be installed in a specific
location (see table below). Prior to installing the driver, either copy
the private key to this location or create a symbolic link.</p>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>DISTRO</strong></td>
<td><strong>MOK PRIVATE KEY</strong></td>
</tr>
<tr class="row-even"><td>Ubuntu/Debian</td>
<td>/var/lib/shim-signed/mok/MOK.priv</td>
</tr>
<tr class="row-odd"><td>RHEL/CentOS</td>
<td>/root/mok.priv</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The MOK directory contains the private key used for signing kernel
modules. It is highly suggested to use disk encryption to avoid leaking
this key to a malicious attacker. Please be aware of the risk.</p>
</div>
<div class="section" id="ubuntu-and-debian-based-systems">
<h3><a class="toc-backref" href="#id9">Ubuntu and Debian Based Systems</a><a class="headerlink" href="#ubuntu-and-debian-based-systems" title="Permalink to this headline">¶</a></h3>
<p>Prior to installing the driver, enable secure boot on the target system. If
secure boot is enabled during driver installation, a MOK will be automatically
generated during install, if it doesn’t already exist in the MOK directory,
and the user will be prompted to enter a temporary password to import the MOK
certificate into the system. This prompt uses a text mode tool, which can be
navigated using TAB to highlight, and ENTER to select.</p>
<p>Reboot the system and the MOK manager will start automatically.</p>
<p>See <a class="reference internal" href="#using-the-mok-manager"><span class="std std-ref">Using the MOK Manager to Enroll the MOK Certificate</span></a> for further instructions.</p>
</div>
<div class="section" id="rhel-centos-systems">
<h3><a class="toc-backref" href="#id10">RHEL/CentOS Systems</a><a class="headerlink" href="#rhel-centos-systems" title="Permalink to this headline">¶</a></h3>
<p>To use secure boot with this driver stack, you must manually import the MOK
certificate onto your system. The driver installation will automatically
generate a MOK if it doesn’t already exist in the MOK directory.</p>
<p>To import the MOK certificate, first install the “mokutil” package using your
package manager:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo yum install mokutil
</pre></div>
</div>
<p>Then run mokutil to import the certificate:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo mokutil --import /root/mok.der
</pre></div>
</div>
<p>Mokutil will require you to provide a temporary password for importing the
certificate. Reboot the system and the MOK manager will start automatically.</p>
<p>See <a class="reference internal" href="#using-the-mok-manager"><span class="std std-ref">Using the MOK Manager to Enroll the MOK Certificate</span></a> for further instructions.</p>
</div>
<div class="section" id="sle-systems">
<h3><a class="toc-backref" href="#id11">SLE Systems</a><a class="headerlink" href="#sle-systems" title="Permalink to this headline">¶</a></h3>
<p>Signing support for dkms requires dkms version 2.8, which is unavailable in
SLE. If DKMS is updated manually by the user, signing can be used in the same
way as RHEL, but this is untested and might not work as intended. Please use at
your own risk.</p>
</div>
<div class="section" id="using-the-mok-manager-to-enroll-the-mok-certificate">
<span id="using-the-mok-manager"></span><h3><a class="toc-backref" href="#id12">Using the MOK Manager to Enroll the MOK Certificate</a><a class="headerlink" href="#using-the-mok-manager-to-enroll-the-mok-certificate" title="Permalink to this headline">¶</a></h3>
<p>After requesting to import the MOK certificate and entering a temporary
password, the MOK manager will start on next boot.</p>
<p>Hit any key to avoid continuing boot. Do no select “Continue Boot”, but rather
select “Enroll MOK” and “View key 0” to confirm that the key is correct.</p>
<p>Select “Continue”, “Yes”, and enter the temporary password to finish enrolling
the key certificate. Select “Reboot” to exit the MOK manager.</p>
<p>The signed driver should now load successfully.</p>
</div>
</div>
<div class="section" id="uninstalling-the-amdgpu-graphics-stack">
<h2><a class="toc-backref" href="#id13">Uninstalling the AMDGPU Graphics Stack</a><a class="headerlink" href="#uninstalling-the-amdgpu-graphics-stack" title="Permalink to this headline">¶</a></h2>
<p>To remove all components of the stack, run the uninstall script from anywhere
in the system.</p>
<ol class="arabic">
<li><p class="first">Based on whether you installed the All-Open or Pro components, run one of
the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use this for All-Open components</span>
$ amdgpu-uninstall

<span class="c1"># Use this for Pro components</span>
$ amdgpu-pro-uninstall
</pre></div>
</div>
</li>
<li><p class="first">After uninstalling the components, reboot the target system.</p>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="install-bugrep.html" class="btn btn-neutral float-right" title="Reporting Bugs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install-script.html" class="btn btn-neutral float-left" title="Using the amdgpu-install Script" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Advanced Micro Devices 2017, 2021

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>